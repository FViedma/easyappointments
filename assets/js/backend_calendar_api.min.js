/* ----------------------------------------------------------------------------
 * Easy!Appointments - Open Source Web Scheduler
 *
 * @package     EasyAppointments
 * @author      A.Tselegidis <alextselegidis@gmail.com>
 * @copyright   Copyright (c) 2013 - 2020, Alex Tselegidis
 * @license     http://opensource.org/licenses/GPL-3.0 - GPLv3
 * @link        http://easyappointments.org
 * @since       v1.2.0
* ---------------------------------------------------------------------------- */ window.BackendCalendarApi=window.BackendCalendarApi||{},function(A){"use strict";A.saveAppointment=function(A,e,n,t){var o=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_appointment",i={csrfToken:GlobalVariables.csrfToken,appointment_data:JSON.stringify(A)};e&&(i.customer_data=JSON.stringify(e)),$.post(o,i).done(function(A){var e,t,o,i,a,f,p,w,F,r,K=A[0],d=A[1],U=A[2],l=A[3];let s;n&&n(A.status),a=K,f=U,p=d,w=l,F=A.number_ticket,r=p.first_name+" "+p.last_name,new QRious({element:document.querySelector("#qr_code"),value:a.hash,size:200,backgroundAlpha:0,foreground:"#000000",level:"H"}),s=$("#qr_code").attr("src"),e=new jsPDF("p","pt",["215","313"]),o=(t=50)+8+3,e.setFont("helvetica"),e.setFontType("bold"),e.setFontSize(12),e.setLineWidth(1.5),e.line(20,13,200,13),e.addImage("data:image/jpeg;base64,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","png",62,190,100,100),e.addImage(s,"png",73,200,80,80),e.setFontSize(16),e.text(15,25,"Hospital Cl\xednico Viedma"),e.text(15,40,"Ficha N\xba:"+F),e.setFontSize(8),e.text(15,t,EALang.attention_date),e.text(145,t,EALang.user_id),e.text(15,t+=22,EALang.service),e.text(15,t+=22,EALang.provider),e.text(15,t+=22,EALang.customer),e.text(15,t+=34,EALang.user),e.text(15,t+=22,EALang.booked),e.setFontSize(12),e.text(15,o,a.start_datetime),e.text(145,o,f.user_ci),e.text(15,o+=23,w.name),e.text(15,o+=23,r),e.text(15,o+=23,f.first_name),e.text(15,o+=12,f.last_name),e.text(15,o+=23,a.user_display_name),e.text(15,o+=23,a.book_datetime),e.setFontSize(8),e.text(15,o+=108,EALang.FirstAdmisionSch),e.text(15,o+=8,EALang.SecondAdmisionSch),i=o+=8,e.line(15,i,200,i),e.save("ficha.pdf")}).fail(function(A,e,n){t&&t()})},A.saveUnavailable=function(A,e,n){var t=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_unavailable",o={csrfToken:GlobalVariables.csrfToken,unavailable:JSON.stringify(A)};$.post(t,o).done(function(A){e&&e(A)}).fail(function(A,e,t){n&&n()})},A.saveWorkingPlanException=function(A,e,n,t,o){var i=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_working_plan_exception",a={csrfToken:GlobalVariables.csrfToken,date:A,working_plan_exception:e,provider_id:n};$.post(i,a).done(function(A){t&&t(A)}).fail(function(A,e,n){o&&o()})},A.deleteWorkingPlanException=function(A,e,n,t){var o=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_delete_working_plan_exception",i={csrfToken:GlobalVariables.csrfToken,date:A,provider_id:e};$.post(o,i).done(function(A){n&&n(A)}).fail(function(A,e,n){t&&t()})},A.getPatientByCI=function(A,e){var n=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_patient_by_ci";$.ajax({url:n,type:"GET",data:{patientCI:A,complement:e},dataType:"json"}).done(function(n){if(0==n.length)$("#form-message").empty(),$("#appointment-message").empty(),$("#save-appointment").prop("disabled",!0),GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_not_found);else if(n.length>0){var t=/[^0-9]+/,o=0;for(function A(e,n){var t=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_patient_reservation";$.ajax({url:t,type:"GET",data:{patientCI:e,complement:n},dataType:"json"}).done(function(A){if(null==A)$("#appointment-message").empty(),GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_not_found);else if(A.length>=1){var e,n,t,o,i,A=A[0];e=new Date(A.book_datetime),n=new Date,t=!1,o=!1,i=!1,e.getFullYear()===e.getFullYear()&&(t=!0),e.getMonth()===n.getMonth()&&(o=!0),e.getDate()===n.getDate()&&(i=!0),t==o&&o==i&&GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_reserved_already+" "+A.book_datetime)}})}(A,e);o<n.length;){if(n[o].HCL_NUMCI.replace(t,"")==A){$("#first-name").val(n[o].HCL_NOMBRE),$("#last-name").val(n[o].HCL_APPAT+" "+n[o].HCL_APMAT),$("#clinical-story").val(n[o].HCL_CODIGO),$("#phone-number").val(n[o].HCL_TELDOM),$("#save-appointment").prop("disabled",!1);break}o++}}else $("#manage-appointment").find("#first-name, #last-name,#clinical-story").val("")})}}(window.BackendCalendarApi);