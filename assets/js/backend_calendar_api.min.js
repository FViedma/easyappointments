/* ----------------------------------------------------------------------------
 * Easy!Appointments - Open Source Web Scheduler
 *
 * @package     EasyAppointments
 * @author      A.Tselegidis <alextselegidis@gmail.com>
 * @copyright   Copyright (c) 2013 - 2020, Alex Tselegidis
 * @license     http://opensource.org/licenses/GPL-3.0 - GPLv3
 * @link        http://easyappointments.org
 * @since       v1.2.0
* ---------------------------------------------------------------------------- */ window.BackendCalendarApi=window.BackendCalendarApi||{},function(e){"use strict";e.saveAppointment=function(e,a,n,t){var i=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_appointment",o={csrfToken:GlobalVariables.csrfToken,appointment_data:JSON.stringify(e)};a&&(o.customer_data=JSON.stringify(a)),$.post(i,o).done(function(e){n&&n(e)}).fail(function(e,a,n){t&&t()})},e.saveUnavailable=function(e,a,n){var t=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_unavailable",i={csrfToken:GlobalVariables.csrfToken,unavailable:JSON.stringify(e)};$.post(t,i).done(function(e){a&&a(e)}).fail(function(e,a,t){n&&n()})},e.saveWorkingPlanException=function(e,a,n,t,i){var o=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_working_plan_exception",p={csrfToken:GlobalVariables.csrfToken,date:e,working_plan_exception:a,provider_id:n};$.post(o,p).done(function(e){t&&t(e)}).fail(function(e,a,n){i&&i()})},e.deleteWorkingPlanException=function(e,a,n,t){var i=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_delete_working_plan_exception",o={csrfToken:GlobalVariables.csrfToken,date:e,provider_id:a};$.post(i,o).done(function(e){n&&n(e)}).fail(function(e,a,n){t&&t()})},e.getPatientByCI=function(e,a){var n=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_patient_by_ci";$.ajax({url:n,type:"GET",data:{patientCI:e,complement:a},dataType:"json"}).done(function(n){if(0==n.length)$("#form-message").empty(),$("#appointment-message").empty(),$("#save-appointment").prop("disabled",!0),GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_not_found);else if(n.length>0){var t=/[^0-9]+/,i=0;for(function e(a,n){var t=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_patient_reservation";$.ajax({url:t,type:"GET",data:{patientCI:a,complement:n},dataType:"json"}).done(function(e){if(null==e)$("#appointment-message").empty(),GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_not_found);else if(e.length>=1){var a,n,t,i,o,e=e[0];a=new Date(e.book_datetime),n=new Date,t=!1,i=!1,o=!1,a.getFullYear()===a.getFullYear()&&(t=!0),a.getMonth()===n.getMonth()&&(i=!0),a.getDate()===n.getDate()&&(o=!0),t==i&&i==o&&GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_reserved_already+" "+e.book_datetime)}})}(e,a);i<n.length;){if(n[i].HCL_NUMCI.replace(t,"")==e){$("#first-name").val(n[i].HCL_NOMBRE),$("#last-name").val(n[i].HCL_APPAT+" "+n[i].HCL_APMAT),$("#clinical-story").val(n[i].HCL_CODIGO),$("#phone-number").val(n[i].HCL_TELDOM),$("#save-appointment").prop("disabled",!1);break}i++}}else $("#manage-appointment").find("#first-name, #last-name,#clinical-story").val("")})}}(window.BackendCalendarApi);